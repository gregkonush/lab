apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: coder
resources:
  - coder-cluster.yaml

helmCharts:
  - name: coder
    namespace: coder
    releaseName: coder
    includeCRDs: true
    version: 2.14.3
    repo: https://helm.coder.com/v2
    valuesInline:
      service:
        type: ClusterIP
      ingress:
        enabled: true
        className: traefik
        host: coder.proompteng.ai
      env:
        - name: CODER_PG_CONNECTION_URL
          valueFrom:
            secretKeyRef:
              name: coder-cluster-app
              key: uri
        - name: CODER_ACCESS_URL
          value: https://coder.proompteng.ai

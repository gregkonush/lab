apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: registry
helmCharts:
  - name: docker-registry
    namespace: registry
    releaseName: docker-registry
    version: 2.2.3
    repo: https://helm.twun.io
    valuesMerge: merge
    valuesInline:
      persistence:
        enabled: true
        size: 100Gi
      ingress:
        enabled: true
        ingressClassName: traefik
        annotations:
          acme.cert-manager.io/http01-edit-in-place: "true"
          cert-manager.io/cluster-issuer: "letsencrypt-prod"
        tls:
          - hosts:
              - registry.grisha.cloud
            secretName: registry-tls
        hosts:
          - registry.grisha.cloud

apiVersion: skaffold/v4beta11
kind: Config
metadata:
  name: prt
build:
  tagPolicy:
    gitCommit:
      variant: AbbrevCommitSha
  artifacts:
    - image: prt
      context: services/prt
      docker:
        dockerfile: Dockerfile
  local:
    push: false
manifests:
  kustomize:
    paths:
      - argocd/applications/prt/base
deploy:
  kubectl: {}
profiles:
  - name: remote
    patches:
      - op: replace
        path: /build/artifacts/0/image
        value: registry.ide-newton.ts.net/lab/prt
      - op: replace
        path: /build/local/push
        value: true
      - op: replace
        path: /manifests/kustomize/paths/0
        value: argocd/applications/prt/overlays/cluster
      - op: add
        path: /build/platforms
        value:
          - linux/arm64

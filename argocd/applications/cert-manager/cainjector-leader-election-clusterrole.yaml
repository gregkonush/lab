apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: cert-manager-cainjector:leaderelection
  labels:
    app: cainjector
    app.kubernetes.io/component: cainjector
    app.kubernetes.io/instance: cert-manager
    app.kubernetes.io/name: cainjector
rules:
  # Grant access to create, update, patch leases in the kube-system namespace
  # The cainjector requires this for leader election.
  - apiGroups: ["coordination.k8s.io"]
    resources: ["leases"]
    verbs: ["get", "create", "update", "patch"]
    # Allow access to the specific lease name used by cainjector in kube-system
    # resourceNames: ["cert-manager-cainjector-leader-election"] # This might be too restrictive depending on cert-manager version/config
    # Alternatively, grant broader access within the namespace if needed,
    # but starting with specific resourceName is safer. Adjust if issues persist.
    namespaces: ["kube-system"] # Ensure leader election lock is in kube-system
